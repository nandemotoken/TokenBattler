<!DOCTYPE html>
<html lang="ja">
        <head>
                <meta charset="UTF-8">
                <title>Dapps front-end</title>
                <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
                <script language="javascript" type="text/javascript" src="./web3.min.js"></script>
                <script language="javascript" type="text/javascript" src="./zorome_abi.js"></script>
        </head>
        <body>
                <h1>Title</h1>
                <div id="front"></div>
                <img id="zoromeimg" src="A.png" >
                <button type="button" id="button_set">Button</button><!-- 追加 -->
        <script>
          window.addEventListener('load', function() {
                  var zorometoken;
                  var userAccount;
                  var addr = web3.eth.accounts[0]

                  function startApp() {
                          //コントラクト読込
                          //ここのアドレスを自分のコントラクトアドレスに書き換える
                          var zoromeAddress = "0xB97E271AF2D0BE27BdA5ab29550D636F31aC4018";
                          zorometoken = web3.eth.contract(zoromeABI).at(zoromeAddress);


                          //ユーザーの登録
                          web3.eth.getAccounts(function(err, accounts) {
                                  console.log(accounts[0]);
                                  userAccount = accounts[0];
                          });



                          //コントラクトから内容の取得
                          zorometoken.symbol.call({from: addr}, function(err, symbol) {
                                  //ABI expects string here,
                                  if(err) { console.log(err) }
                                  console.log('Token symbol: ' + symbol)
                          })


                          document.getElementById("button_set").onclick = () => {
                                  getAmount();
                          }

                          document.getElementById('zoromeimg').onclick = () =>{
                                  imgClick();
                          }

                  }


                  function getAmount(){
                          return zorometoken.balanceOf.call( web3.eth.accounts[0]  , function(err, bal) {
                                  if(err) { console.log(err) }
                                  console.log('you have: ' + bal + 'zorome token')
                                  alert("右のボタン"+ bal )
                          })

                  }

                  function imgClick() {
                          alert("左の画像");
                          zorometoken.zoromeChallenge({ from:addr} , function (err , txHash) {
                                  if(err) console.error(err)
                                  if (txHash) {
                                          console.log('Transaction sent')
                                          console.dir(txHash)
                                  }
                          });
                  }


                  //MetaMaskがインストールされているかのチェック
                  if (typeof web3 !== 'undefined') {
                          // メタマスクのWeb3のプロバイダを使用する。
                          web3js = new Web3(web3.currentProvider);
                          alert("イーサリアムウォレットを利用します");
                  } else {
                          // メタマスクがインストールされていない場合、メタマスクのインストールを促す
                          alert("イーサリアムウォレットを導入してください(MetaMask等)");
                  }

                  // ユーザーのアプリ開始
                  startApp()
          })
        </script>

        </br>
        </br>
        </br>
        </br>
        </br>
        </br>
        </br>
        </br>
        </br>
        </body>
